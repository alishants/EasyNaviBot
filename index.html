<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigation Mini App</title>
    <style>
        :root {
            /* Тёмная тема */
            --bg-color: #000000;
            --container-bg: rgba(30, 30, 30, 0.9);
            --text-color: #ffffff;
            --button-bg: linear-gradient(90deg, #0f2027, #203a43, #2c5364);
            --title-color: #00ffff;
            --shadow-color: rgba(0, 255, 255, 0.5);
            --icon-color: #ff4d4d;
            --input-border-color: #ccc;
            --input-bg: #1e1e1e;
            --history-hover-bg: rgba(0, 255, 255, 0.1);
        }

        [data-theme="light"] {
            /* Светлая тема */
            --bg-color: #f9f9f9;
            --container-bg: #ffffff;
            --text-color: #333333;
            --button-bg: linear-gradient(90deg, #e0eafc, #cfdef3);
            --title-color: #0057ff;
            --shadow-color: rgba(0, 87, 255, 0.5);
            --icon-color: #ff3333;
            --input-border-color: #aaa;
            --input-bg: #f1f1f1;
            --history-hover-bg: rgba(0, 87, 255, 0.1);
        }

        body {
            margin: 0;
            font-family: 'Roboto', sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding-top: 80px;
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            text-align: center;
            background: var(--container-bg);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 25px var(--shadow-color);
            max-width: 400px;
            width: 100%;
            position: relative;
            transition: background-color 0.3s, box-shadow 0.3s;
        }

        .help-icon {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 24px;
            color: var(--icon-color);
            cursor: pointer;
        }

        h1 {
            font-size: 28px;
            margin-bottom: 20px;
            color: var(--title-color);
            cursor: pointer;
            transition: color 0.3s;
        }

        .input-wrapper {
            position: relative;
        }

        input[type="text"] {
            width: calc(100% - 20px);
            padding: 14px;
            border-radius: 10px;
            border: 1px solid var(--input-border-color);
            outline: none;
            font-size: 18px;
            background: var(--input-bg);
            color: var(--text-color);
            transition: background-color 0.3s, border-color 0.3s, color 0.3s;
        }

        button {
            background: var(--button-bg);
            color: var(--text-color);
            border: none;
            border-radius: 12px;
            padding: 14px 25px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.3s, color 0.3s;
        }

        .interactive-text {
            font-size: 14px;
            margin-top: 20px;
            color: var(--title-color);
            cursor: pointer;
        }

        .interactive-text:hover {
            text-decoration: underline;
        }

        .modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 400px;
            background: var(--container-bg);
            color: var(--text-color);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 25px var(--shadow-color);
            display: none;
            z-index: 1000;
            transition: background-color 0.3s, color 0.3s;
        }

        .modal.active {
            display: block;
        }

        .close-modal {
            text-align: right;
            font-size: 18px;
            cursor: pointer;
            margin-bottom: 10px;
        }

        ul.history-list {
            list-style: none;
            padding: 0;
            margin-top: 10px;
        }

        ul.history-list li {
            padding: 10px;
            border-bottom: 1px solid var(--input-border-color);
            cursor: pointer;
            text-align: left;
            transition: background-color 0.3s;
        }

        ul.history-list li:hover {
            background-color: var(--history-hover-bg);
        }
    </style>
</head>
<body>
<div class="container">
    <span class="help-icon" onclick="toggleHelpModal()">❓</span>
    <h1 onclick="toggleTheme()">Navigation Mini App</h1>
    <div class="input-wrapper">
        <input type="text" id="searchInput" placeholder="Enter location...">
    </div>
    <button onclick="search()">Search</button>
    <div class="interactive-text" onclick="showExample()">Need ideas? Click here!</div>
    <h3>Search History</h3>
    <ul class="history-list" id="historyList"></ul>

    <!-- Контейнер для отображения результата -->
    <div id="resultContainer" style="margin-top: 20px; display: none;">
        <iframe id="mapResult" style="width: 100%; height: 300px; border: 0; border-radius: 10px;"></iframe>
    </div>
</div>

<script>
    const historyList = document.getElementById("historyList");
    const body = document.body;

    function search() {
        const query = document.getElementById("searchInput").value.trim();
        if (!query) {
            alert("Please enter a location to search!");
            return;
        }

        const isAddress = /\d+/.test(query);
        const isStreet = /\b(street|avenue|road|boulevard|drive|lane|carrer|calle)\b/i.test(query);
        const isMetro = /\b(station|metro|underground|subway)\b/i.test(query) || /Sagrera|Verdaguer|Diagonal|Passeig de Gràcia/i.test(query);
        const isPlace = /\b(plaza|square|park|area)\b/i.test(query);

        let googleMapsUrl;

        if (isAddress || isMetro) {
            googleMapsUrl = `https://www.google.com/maps/embed/v1/directions?key=AIzaSyBATkE39afAqUS7riPFCyKsmpkPTwdPpDI&destination=${encodeURIComponent(query)}`;
        } else if (isStreet || isPlace) {
            googleMapsUrl = `https://www.google.com/maps/embed/v1/search?key=AIzaSyBATkE39afAqUS7riPFCyKsmpkPTwdPpDI&q=${encodeURIComponent(query)}`;
        } else {
            googleMapsUrl = `https://www.google.com/maps/embed/v1/search?key=AIzaSyBATkE39afAqUS7riPFCyKsmpkPTwdPpDI&q=${encodeURIComponent(query)}+near+me`;
        }

        // Показать результат внутри iframe
        const resultContainer = document.getElementById("resultContainer");
        const mapResult = document.getElementById("mapResult");

        mapResult.src = googleMapsUrl;
        resultContainer.style.display = "block";

        saveToHistory(query);
        updateHistoryList();
    }

    function saveToHistory(query) {
        const history = JSON.parse(localStorage.getItem("searchHistory") || "[]");
        if (!history.includes(query)) {
            history.unshift(query);
            if (history.length > 10) history.pop();
            localStorage.setItem("searchHistory", JSON.stringify(history));
        }
    }

    function updateHistoryList() {
        const history = JSON.parse(localStorage.getItem("searchHistory") || "[]");
        historyList.innerHTML = history.map(item => `<li onclick="setSearch('${item}')">${item}</li>`).join("");
    }

    function setSearch(value) {
        document.getElementById("searchInput").value = value;
    }

    function toggleHelpModal() {
        const helpModal = document.getElementById("helpModal");
        helpModal.classList.toggle("active");
    }

    function toggleTheme() {
        if (body.dataset.theme === "light") {
            body.dataset.theme = "dark";
        } else {
            body.dataset.theme = "light";
        }
    }

    function showExample() {
        const examples = [
            "Restaurants",
            "Carrer",
            "Carrer de",
            "Coffee shops",
            "Plaza Catalunya",
            "ATMs",
            "Carrer",
            "Pharmacies",
            "Tapas",
            "Sagrada Familia",
            "Metro Sagrera",
            "Shopping malls",
            "Carrer de",
            "Plaza",
            "Metro",
            "Fast food",
            "Gyms",
            "Bookstores",
            "Shopping malls",
            "Cafe",
            "Tabac shops",
            "Metro",
            "Hospitals",
            "Clinics",
            "Parking lots",
        ];
        const randomExample = examples[Math.floor(Math.random() * examples.length)];
        document.getElementById("searchInput").value = randomExample;
    }

    // Initialize history on page load
    updateHistoryList();
    // Set default theme to dark
    body.dataset.theme = "dark";
</script>

        const historyList = document.getElementById("historyList");
        const body = document.body;

        function search() {
            const query = document.getElementById("searchInput").value.trim();
            if (!query) {
                alert("Please enter a location to search!");
                return;
            }

            const isAddress = /\d+/.test(query);
            const isStreet = /\b(street|avenue|road|boulevard|drive|lane|carrer|calle)\b/i.test(query);
            const isMetro = /\b(station|metro|underground|subway)\b/i.test(query) || /Sagrera|Verdaguer|Diagonal|Passeig de Gràcia/i.test(query);
            const isPlace = /\b(plaza|square|park|area)\b/i.test(query);

            let googleMapsUrl;

            if (isAddress || isMetro) {
                googleMapsUrl = `https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(query)}`;
            } else if (isStreet || isPlace) {
                googleMapsUrl = `https://www.google.com/maps/search/${encodeURIComponent(query)}`;
            } else {
                googleMapsUrl = `https://www.google.com/maps/search/${encodeURIComponent(query)}+near+me`;
            }

            window.open(googleMapsUrl, "_blank");
            saveToHistory(query);
            updateHistoryList();
        }

        function saveToHistory(query) {
            const history = JSON.parse(localStorage.getItem("searchHistory") || "[]");
            if (!history.includes(query)) {
                history.unshift(query);
                if (history.length > 10) history.pop();
                localStorage.setItem("searchHistory", JSON.stringify(history));
            }
        }

        function updateHistoryList() {
            const history = JSON.parse(localStorage.getItem("searchHistory") || "[]");
            historyList.innerHTML = history.map(item => `<li onclick="setSearch('${item}')">${item}</li>`).join("");
        }

        function setSearch(value) {
            document.getElementById("searchInput").value = value;
        }

        function toggleHelpModal() {
            const helpModal = document.getElementById("helpModal");
            helpModal.classList.toggle("active");
        }

        function toggleTheme() {
            if (body.dataset.theme === "light") {
                body.dataset.theme = "dark";
            } else {
                body.dataset.theme = "light";
            }
        }

        function showExample() {
            const examples = [
                "Restaurants",
                "Carrer",
                "Carrer de",
                "Coffee shops",
                "Plaza Catalunya",
                "ATMs",
                "Carrer",
                "Pharmacies",
                "Tapas",
                "Sagrada Familia",
                "Metro Sagrera",
                "Shopping malls",
                "Carrer de",
                "Plaza",
                "Metro",
                "Fast food",
                "Gyms",
                "Bookstores",
                "Shopping malls",
                "Cafe",
                "Tabac shops",
                "Metro",
                "Hospitals",
                "Clinics",
                "Parking lots",
            ];
            const randomExample = examples[Math.floor(Math.random() * examples.length)];
            document.getElementById("searchInput").value = randomExample;
        }

        // Initialize history on page load
        updateHistoryList();
        // Set default theme to dark
        body.dataset.theme = "dark";
    </script>
</body>
</html>
